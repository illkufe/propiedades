{% extends 'index.html' %}
{% block section %}

{% include 'partials/breadcrumbs-bar.html' %}

<div class="wrapper wrapper-content">
	<div class="row">
		<div class="col-lg-12">
			<div class="ibox float-e-margins">
				<form id="form-contrato-new" role="form" action="" method="post">
					{% csrf_token %}

					<div class="ibox-title">
						<h5>Información General</h5>
					</div>

					<div class="ibox-content">
						<div class="row">
							<div class="col-sm-12">

								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.numero.help_text }}" ></i>
									{{ form.numero.label_tag }}
									{{ form.numero }}
									<div class="container-error">
										{{ form.numero.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.nombre_local.help_text }}" ></i>
									{{ form.nombre_local.label_tag }}
									{{ form.nombre_local }}
									<div class="container-error">
										{{ form.nombre_local.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.tipo.help_text }}" ></i>
									{{ form.tipo.label_tag }}
									{{ form.tipo }}
									<div class="container-error">
										{{ form.tipo.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.cliente.help_text }}" ></i>
									{{ form.cliente.label_tag }}
									<div class="input-group">
										{{ form.cliente }}
										<span class="input-group-addon" onclick="open_form_cliente()">
											<i class="fa fa-plus"></i>
										</span>
									</div>

									<div class="container-error">
										{{ form.cliente.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-4">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.locales.help_text }}" ></i>
									{{ form.locales.label_tag }}
									<div class="input-group">
										<div class="ads">
											{{ form.locales }}
										</div>
										<span class="input-group-addon" onclick="open_tabla_locales()">
											<i class="fa fa-search"></i>
										</span>
									</div>

									<div class="container-error">
										{{ form.locales.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-8">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.destino_comercial.help_text }}" ></i>
									{{ form.destino_comercial.label_tag }}
									{{ form.destino_comercial }}
									<div class="container-error">
										{{ form.destino_comercial.errors|striptags }}
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="ibox-title">
						<h5>Período</h5>
					</div>

					<div class="ibox-content">
						<div class="row">
							<div class="col-sm-12">

								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.fecha_contrato.help_text }}" ></i>
									{{ form.fecha_contrato.label_tag }}
									<div class="input-group date">
										{{ form.fecha_contrato }}
										<span class="input-group-addon">
											<i class="fa fa-calendar"></i>
										</span>
									</div>

									<div class="container-error">
										{{ form.fecha_contrato.errors|striptags }}
									</div>
								</div>

								<div id="date_range">
									<div class="input-daterange">

										<div class="form-group col-sm-3">
											<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.fecha_inicio.help_text }}" ></i>
											{{ form.fecha_inicio.label_tag }}
											<div class="input-group">
												{{ form.fecha_inicio }}
												<span class="input-group-addon">
													<i class="fa fa-calendar"></i>
												</span>
											</div>
											<div class="container-error">
												{{ form.fecha_inicio.errors|striptags }}
											</div>
										</div>

										<div class="form-group col-sm-3">
											<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.fecha_termino.help_text }}" ></i>
											{{ form.fecha_termino.label_tag }}

											<div class="input-group">
												{{ form.fecha_termino }}
												<span class="input-group-addon">
													<i class="fa fa-calendar"></i>
												</span>
											</div>

											<div class="container-error">
												{{ form.fecha_termino.errors|striptags }}
											</div>
										</div>
									</div>
								</div>

								<div class="form-group col-sm-2">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.meses.help_text }}" ></i>
									{{ form.meses.label_tag }}
									{{ form.meses }}
									<div class="container-error">
										{{ form.meses.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-3 date" id="fecha_habilitacion">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.fecha_habilitacion.help_text }}" ></i>
									{{ form.fecha_habilitacion.label_tag }}
									<div class="input-group date">
										{{ form.fecha_habilitacion }}
										<span class="input-group-addon">
											<i class="fa fa-calendar"></i>
										</span>
									</div>

									<div class="container-error">
										{{ form.fecha_habilitacion.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-3 date" id="data_2">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.fecha_renovacion.help_text }}" ></i>
									{{ form.fecha_renovacion.label_tag }}
									<div class="input-group date">
										{{ form.fecha_renovacion }}
										<span class="input-group-addon">
											<i class="fa fa-calendar"></i>
										</span>
									</div>
									<div class="container-error">
										{{ form.fecha_renovacion.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-3 date" id="data_2">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.fecha_remodelacion.help_text }}" ></i>
									{{ form.fecha_remodelacion.label_tag }}
									<div class="input-group date">
										{{ form.fecha_remodelacion }}
										<span class="input-group-addon">
											<i class="fa fa-calendar"></i>
										</span>
									</div>
									<div class="container-error">
										{{ form.fecha_remodelacion.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-3 date" id="data_2">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.fecha_aviso.help_text }}" ></i>
									{{ form.fecha_aviso.label_tag }}
									<div class="input-group date">
										{{ form.fecha_aviso }}
										<span class="input-group-addon">
											<i class="fa fa-calendar"></i>
										</span>
									</div>
									<div class="container-error">
										{{ form.fecha_aviso.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-3 date" id="data_2">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.fecha_plazo.help_text }}" ></i>
									{{ form.fecha_plazo.label_tag }}
									<div class="input-group date">
										{{ form.fecha_plazo }}
										<span class="input-group-addon">
											<i class="fa fa-calendar"></i>
										</span>
									</div>
									<div class="container-error">
										{{ form.fecha_plazo.errors|striptags }}
									</div>
								</div>

								<div class="form-group col-sm-2">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.dias_salida.help_text }}" ></i>
									{{ form.dias_salida.label_tag }}
									{{ form.dias_salida }}
									<div class="container-error">
										{{ form.dias_salida.errors|striptags }}
									</div>
								</div>

							</div>
						</div>
					</div>

					<div class="ibox-title">
						<h5>Concepto</h5>
					</div>

					<div class="ibox-content">
						<div class="row">

							<div class="col-xs-12">
								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.arriendo_minimo.help_text }}" ></i>
									{{ form.arriendo_minimo.label_tag }}
									<div class="checkbox checkbox-primary">
										{{ form.arriendo_minimo }}
										<label for="checkbox2"></label>
									</div>
									<div class="container-error">
										{{ form.arriendo_minimo.errors|striptags }}
									</div>
								</div>
							</div>

							<div class="col-xs-12">
								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.arriendo_variable.help_text }}" ></i>
									{{ form.arriendo_variable.label_tag }}
									<div class="checkbox checkbox-primary">
										{{ form.arriendo_variable }}
										<label for="checkbox2"></label>
									</div>
									<div class="container-error">
										{{ form.arriendo_variable.errors|striptags }}
									</div>
								</div>
							</div>

							<div class="col-xs-12">
								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.arriendo_bodega.help_text }}" ></i>
									{{ form.arriendo_bodega.label_tag }}
									<div class="checkbox checkbox-primary">
										{{ form.arriendo_bodega }}
										<label for="checkbox2"></label>
									</div>
									<div class="container-error">
										{{ form.arriendo_bodega.errors|striptags }}
									</div>
								</div>
							</div>

							<div class="col-xs-12">
								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.cuota_incorporacion.help_text }}" ></i>
									{{ form.cuota_incorporacion.label_tag }}
									<div class="checkbox checkbox-primary">
										{{ form.cuota_incorporacion }}
										<label for="checkbox2"></label>
									</div>
									<div class="container-error">
										{{ form.cuota_incorporacion.errors|striptags }}
									</div>
								</div>
							</div>

							<div class="col-xs-12">
								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.fondo_promocion.help_text }}" ></i>
									{{ form.fondo_promocion.label_tag }}
									<div class="checkbox checkbox-primary">
										{{ form.fondo_promocion }}
										<label for="checkbox2"></label>
									</div>
									<div class="container-error">
										{{ form.fondo_promocion.errors|striptags }}
									</div>
								</div>
							</div>

							<div class="col-xs-12">
								<div class="form-group col-sm-3">
									<i class="fa fa-question-circle info-label" data-toggle="tooltip" data-placement="top" title="{{ form.gasto_comun.help_text }}" ></i>
									{{ form.gasto_comun.label_tag }}
									<div class="checkbox checkbox-primary">
										{{ form.gasto_comun }}
										<label for="checkbox2"></label>
									</div>
									<div class="container-error">
										{{ form.gasto_comun.errors|striptags }}
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="ibox-content">
						<div class="row">
							<div class="col-sm-12">
								<a href='{% url "propuesta_list" %}'><button class="btn btn-w-m btn-sm btn-default" type="button" style="margin-right: 15px;">CANCELAR</button></a>
								<button class="btn btn-w-m btn-sm btn-primary pull-right" type="submit">GUARDAR Y SALIR</button>
								<button class="btn btn-w-m btn-sm btn-primary pull-right" type="button" style="margin-right: 15px;" onclick="guardar_formulario('{{accion}}', 'form-contrato-new')">GUARDAR Y SEGUIR</button>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>

{% endblock section %}

{% block scripts %}
<script>

var tabla_locales = []

$(document).ready(function(){

	initialize()

});

function initialize(){

	// cambio en fecha inicio
	$('input[name="fecha_inicio"]').change(function(){
		var fecha_inicio = $(this).val().split('/')
		if ($('input[name="fecha_termino"]').val() != '') {

			var fecha_termino 	= $('input[name="fecha_termino"]').val().split('/')
			fecha_inicio 		= new Date(parseInt(fecha_inicio[2]), parseInt(fecha_inicio[1]-1), parseInt(fecha_inicio[0]));
			fecha_termino 		= new Date(parseInt(fecha_termino[2]), parseInt(fecha_termino[1]-1), parseInt(fecha_termino[0]));

			var meses = diferencia_entre_meses(fecha_inicio, fecha_termino)
			$('input[name="meses"]').val(meses)
		}
	})

	// cambio en fecha término
	$('input[name="fecha_termino"]').change(function(){
		var fecha_termino = $(this).val().split('/')
		if ($('input[name="fecha_inicio"]').val() != '') {

			var fecha_inicio 	= $('input[name="fecha_inicio"]').val().split('/')
			fecha_inicio 		= new Date(parseInt(fecha_inicio[2]), parseInt(fecha_inicio[1]-1), parseInt(fecha_inicio[0]));
			fecha_termino 		= new Date(parseInt(fecha_termino[2]), parseInt(fecha_termino[1]-1), parseInt(fecha_termino[0]));

			var meses = diferencia_entre_meses(fecha_inicio, fecha_termino)
			$('input[name="meses"]').val(meses)
		}
	})

	// cambio en los meses
	$('input[name="meses"]').change(function(){
		var meses =  $(this).val()
		if ($('input[name="fecha_inicio"]').val() != '') {

			var fecha 	= $('input[name="fecha_inicio"]').val().split('/')
			fecha 		= new Date(parseInt(fecha[2]), parseInt(fecha[1]-1), parseInt(fecha[0]));
			fecha.setMonth(fecha.getMonth() + parseInt(meses));

			var dia  = fecha.getDate() < 10 ? '0'+fecha.getDate() : fecha.getDate()
			var mes  = fecha.getMonth()+1 < 10 ? '0'+(fecha.getMonth()+1) : fecha.getMonth()+1
			var anio = fecha.getFullYear()

			$('input[name="fecha_termino"]').val(dia+'/'+mes+'/'+anio)
		}
	})

}

</script>
{% endblock scripts %}